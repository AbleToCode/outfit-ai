# 函数计算 FC 部署详细步骤

## 步骤 1：登录阿里云

1. 访问：https://fc-next.console.aliyun.com/
2. 使用阿里云账号登录
3. 首次使用会提示开通函数计算，点击"立即开通"

---

## 步骤 2：创建服务

1. 点击左侧菜单"服务及函数"
2. 点击"创建服务"按钮
3. 填写表单：
   - **服务名称**: `outfit-api`
   - **地域**: 华东 1（杭州）或离你最近的区域
   - **描述**: Outfit 应用 API 代理服务
4. 点击"确定"

---

## 步骤 3：创建函数

1. 进入刚创建的 `outfit-api` 服务
2. 点击"创建函数"
3. 选择"**事件函数**"
4. 填写基本信息：
   - **运行环境**: Node.js 18
   - **函数名称**: `outfit-analyze`
   - **函数代码上传方式**: 上传 ZIP 包
   - **上传文件**: 选择本地的 `fc-function.zip`
   - **执行方法**: `index.handler`
   - **内存**: 256 MB
   - **超时时间**: 60 秒

---

## 步骤 4：配置环境变量（重要！）

1. 在"环境变量"区域，点击"添加环境变量"
2. 填写：
   - **变量名**: `DASHSCOPE_API_KEY`
   - **变量值**: `sk-36f3fe3e7d60407482f9e538978916a0`
3. 点击"确定"

---

## 步骤 5：创建 HTTP 触发器

1. 函数创建完成后，进入函数详情页
2. 点击"触发器"标签页
3. 点击"创建触发器"
4. 填写：
   - **触发器类型**: HTTP
   - **触发器名称**: `http-trigger`
   - **认证方式**: 无（或 API 密钥，更安全）
   - **请求方法**: POST
   - **请求路径**: `/`（默认）
5. 点击"确定"

---

## 步骤 6：获取 API 地址

1. 触发器创建完成后，在触发器列表中找到刚创建的触发器
2. 复制"触发器地址"或"URL"
3. 格式类似：
   ```
   https://fc-xxx-xxx.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/outfit-api/outfit-analyze/
   ```
4. **保存此 URL**，后续步骤需要

---

## 步骤 7：测试函数

1. 在函数详情页，点击"代码执行"标签
2. 点击"创建测试事件"
3. 事件名称：`test-analyze`
4. 请求参数（JSON）：
   ```json
   {
     "body": "{\"image\":\"data:image/jpeg;base64,/9j/4AAQSkZJRg...\",\"prompt\":\"Analyze this outfit\"}"
   }
   ```
5. 点击"执行"
6. 查看执行结果和日志

---

## 常见问题

### Q1: 找不到"创建服务"按钮
A: 确保已开通函数计算服务，刷新页面重试

### Q2: ZIP 包上传失败
A: 确保 `fc-function.zip` 包含：
- `index.js`
- `package.json`

### Q3: 函数执行超时
A: 增加超时时间到 60 秒或更长

### Q4: 环境变量不生效
A: 检查变量名是否完全匹配 `DASHSCOPE_API_KEY`

---

## 完成标志

当你看到以下信息时，表示 FC 部署成功：
- ✅ 服务 `outfit-api` 创建成功
- ✅ 函数 `outfit-analyze` 创建成功
- ✅ HTTP 触发器创建成功
- ✅ 已复制触发器 URL

---

## 下一步

完成 FC 部署后，继续部署 OSS：
1. 访问：https://oss.console.aliyun.com/
2. 创建 Bucket
3. 上传 `dist/` 目录文件
